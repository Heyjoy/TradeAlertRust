# AI协作开发工作流程指南

> 📋 本文档定义了TradeAlertRust项目中人类与AI协作的标准工作流程
> 🎯 目标：最大化开发效率，确保代码质量，维护项目一致性

## 🚀 **工作会话启动流程**

### **步骤1: 环境准备 (2分钟)**
```bash
# 运行启动脚本
scripts/development/start_work_session.bat

# 或手动执行
scripts/development/check_env.bat  # 环境检查
git status                         # 检查未提交更改
cargo check                        # 验证编译状态
```

### **步骤2: AI上下文建立**
AI会自动读取以下关键文档：
- `docs/START_HERE.md` - 项目概览和AI启动指南
- `tasks/current-tasks.md` - 当前任务状态
- `docs/development-status.md` - 项目整体进展
- `.cursorrules` - 项目开发规范

### **步骤3: 工作目标确认**
用户需要明确告诉AI：
```markdown
今日工作目标:
- [ ] 具体要完成的功能
- [ ] 需要解决的问题
- [ ] 预期工作时间
- [ ] 优先级排序
```

## 🔄 **开发执行流程**

### **AI专家模式选择**
根据任务类型选择合适的AI专家模式：

| 模式代码 | 专家类型 | 适用场景 |
|---------|---------|---------|
| `re` | Rust Expert | 核心功能开发、性能优化 |
| `ta` | Trading Analyst | 交易逻辑、策略实现 |
| `sa` | Security Auditor | 安全审查、漏洞修复 |
| `do` | DevOps Engineer | 部署、CI/CD、运维 |
| `ar` | System Architect | 架构设计、重构 |
| `dw` | Documentation Writer | 文档编写、注释 |
| `qa` | QA Engineer | 测试、质量保证 |

### **标准开发循环**

#### **🎯 任务分析阶段**
```markdown
1. 需求澄清
   - 明确功能边界
   - 确定验收标准
   - 识别依赖关系

2. 技术方案设计
   - 选择实现路径
   - 评估复杂度
   - 预估工作量

3. 风险识别
   - 技术风险
   - 时间风险
   - 质量风险
```

#### **⚡ 代码实现阶段**
```markdown
1. 遵循项目规范
   - 参考 .cursorrules
   - 使用 .cursor/rules/*.mdc 指导
   - 保持代码风格一致

2. 实时质量保证
   - 边写边测试
   - 及时代码审查
   - 持续重构优化

3. 文档同步更新
   - 更新函数注释
   - 更新API文档
   - 记录重要决策
```

#### **✅ 验证确认阶段**
```markdown
1. 代码质量检查
   cargo check    # 编译检查
   cargo clippy   # 代码规范
   cargo fmt      # 格式化
   cargo test     # 运行测试

2. 功能验证
   - 手动测试核心功能
   - 验证边界条件
   - 确认性能指标

3. 文档验证
   - 检查文档完整性
   - 验证示例代码
   - 确认API文档准确性
```

## 📊 **工作会话收尾流程**

### **步骤1: 质量检查 (3分钟)**
```bash
# 运行收尾脚本
scripts/development/end_work_session.bat

# 或手动执行
cargo check --quiet    # 编译检查
cargo clippy --quiet   # 代码规范检查
cargo test --quiet     # 测试运行
cargo fmt              # 代码格式化
git status --short     # 查看更改
```

### **步骤2: 文档更新 (2分钟)**
更新以下关键文档：
```markdown
tasks/current-tasks.md:
- [x] 标记完成的任务
- [ ] 添加新发现的任务
- 📝 更新进度状态

docs/development-status.md:
- 📈 更新功能完成度
- 🚨 记录新的技术债务
- 💡 记录重要决策
```

### **步骤3: 版本控制 (2分钟)**
```bash
# 提交更改
git add .
git commit -m "feat: 简洁描述完成的功能

详细说明:
- 具体实现的功能
- 解决的问题
- 重要的技术决策

相关: #issue_number"

# 推送到远程
git push origin main
```

### **步骤4: 工作总结**
AI自动生成工作总结：
```markdown
## 今日工作总结 (YYYY-MM-DD)

### ✅ 完成的任务
- [具体功能1] - 实现状态和质量
- [具体功能2] - 解决的问题
- [文档更新] - 更新的内容

### 📈 项目进展
- 整体进度: X%
- 新增代码行数: X行
- 测试覆盖率: X%

### 🔧 技术决策
- [决策1]: 原因和影响
- [决策2]: 替代方案和选择理由

### 🚨 待解决问题
- [问题1]: 优先级和预期解决时间
- [问题2]: 需要的资源和支持

### 📋 明日计划
- [任务1]: 预期工作量
- [任务2]: 依赖关系
```

## 🎯 **协作最佳实践**

### **🤖 AI协作技巧**
1. **明确指令**: 使用具体、清晰的描述
2. **上下文提供**: 引用相关文件和代码片段
3. **迭代改进**: 通过多轮对话完善方案
4. **及时反馈**: 对AI建议给出明确反馈

### **📋 任务管理技巧**
1. **小步快跑**: 将大任务分解为小任务
2. **优先级管理**: 重要且紧急的任务优先
3. **进度跟踪**: 及时更新任务状态
4. **风险预警**: 提前识别和应对风险

### **🔄 持续改进**
1. **回顾总结**: 定期回顾工作流程效果
2. **工具优化**: 根据使用情况优化脚本和工具
3. **规范更新**: 根据项目发展更新开发规范
4. **知识积累**: 将经验和教训文档化

## 🚨 **常见问题和解决方案**

### **Q: AI理解错误怎么办？**
A: 提供更多上下文，引用具体文件和代码，使用@符号引用相关文档

### **Q: 代码质量检查失败？**
A: 运行 `cargo clippy --fix` 自动修复，手动解决复杂问题

### **Q: 测试失败怎么处理？**
A: 分析失败原因，修复代码或更新测试，确保功能正确性

### **Q: 如何处理大型重构？**
A: 分阶段进行，每个阶段确保编译通过，及时提交保存进度

## 📞 **获取帮助**

### **文档资源**
- 项目结构: `docs/PROJECT_STRUCTURE.md`
- 技术规范: `docs/technical-specs.md`
- 部署指南: `docs/deployment/`

### **工具脚本**
- 环境检查: `scripts/development/check_env.bat`
- 会话启动: `scripts/development/start_work_session.bat`
- 会话结束: `scripts/development/end_work_session.bat`

---

**🎯 记住：好的协作流程是高效开发的基础！** 