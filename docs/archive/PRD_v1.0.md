# 交易预警系统 PRD（产品需求文档）

## 一、产品背景与目标

随着美股市场的活跃，越来越多的投资者希望能够及时获知自己关注的股票价格变动，尤其是在价格达到某个关键点位时收到提醒。该系统旨在为用户提供一个便捷的美股价格预警服务，支持自定义价格条件、自动检测、邮件通知等功能。用户也可以在本地自定义规则。获得私人化提醒的功能。

## 二、核心功能

### 1. 提醒管理
- 创建新的价格提醒
  * 选择股票号码
  * 设置价格条件（高于/低于）
  * 设置通知方式
- 查看所有活跃提醒
  * 列表显示
  * 状态标识
  * 快速操作
- 修改现有提醒
  * 更新价格条件
  * 更新通知设置
- 删除/取消提醒
- 查看历史提醒记录

### 2. 价格监控
- 定时获取实时价格数据
  * 支持多个交易所
  * 可配置更新频率
- 价格条件判断
  * 高于指定价格
  * 低于指定价格
  * 支持百分比变化
- 触发提醒机制

### 3. 通知系统
- 网页实时提醒
  * WebSocket 实时推送
  * 浏览器通知
- 邮件通知
- 提醒历史记录
  * 触发时间
  * 触发价格
  * 通知状态

### 4. 用户界面
- 提醒列表页面
  * 响应式设计
  * 实时更新状态
  * 快速操作按钮
- 创建/编辑提醒表单
  * 用户友好的输入
  * 实时验证
- 历史记录查看
  * 过滤和排序
  * 详细信息显示
- 实时价格显示
  * 价格走势图
  * 最新成交价

## 三、用户故事

- 作为用户，我可以添加一个股票价格预警（如AAPL高于200美元时通知我），并填写我的邮箱。
- 作为用户，我可以随时查看我所有的预警和历史触发记录。
- 作为用户，我可以删除不再需要的预警。
- 作为用户，当价格达到条件时，我会收到一封邮件提醒。

## 四、技术方案

- **后端框架**：Rust + Axum
- **数据库**：SQLite（后续可扩展为PostgreSQL等）
- **定时任务**：tokio-cron-scheduler
- **行情数据源**：Yahoo Finance API
- **模板引擎**：Askama
- **邮件服务**：SMTP（如QQ邮箱、Gmail等）

## 五、数据结构（简化版）

- alerts（预警表）：id, symbol, condition, price, status, created_at, updated_at, triggered_at
- alert_history（历史表）：id, alert_id, symbol, triggered_price, price, triggered_at
- price_history（价格表）：id, symbol, price, volume, timestamp

## 六、非功能需求

- 稳定性：定时任务需稳定运行，异常自动重试
- 易用性：前端界面简洁明了

## 七、未来规划

- 支持多种通知方式（如微信、短信）
- 支持更多行情源
- 支持多用户账号体系
- 支持自定义定时频率
